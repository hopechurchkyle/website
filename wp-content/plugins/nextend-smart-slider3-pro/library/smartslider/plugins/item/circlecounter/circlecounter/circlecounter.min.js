N2Require("ItemCirclecounter",["Item"],["smartSlider"],function(t,e,r,a){"use strict";function s(){this.type="circlecounter",e.Item.prototype.constructor.apply(this,arguments)}return s.prototype=Object.create(e.Item.prototype),s.prototype.constructor=s,s.needSize=!1,s.prototype.getName=function(t){return"Circle Counter"},s.prototype.added=function(){this.needFill=["label"],this.addedFont("simple","font"),this.addedFont("simple","fontlabel"),r.generator.registerField(t("#item_circlecounterlabel"))},s.prototype._render=function(e){e.value=parseInt(e.value),e.min=Math.min(0,e.value),e.strokewidth=parseInt(e.strokewidth),e.size=Math.max(parseInt(e.size),e.strokewidth+1),e.startvalue=Math.max(parseInt(e.startvalue),e.min),e.total=Math.max(Math.max(parseInt(e.total),e.startvalue),e.value);var r=(Math.min(e.startvalue,e.total)-e.min)/(e.total-e.min),a=(Math.min(e.value,e.total)-e.min)/(e.total-e.min),s=t('<div class="n2-ss-item-circlecounter-counting-div '+e.fontclass+' n2-ow"></div>'),i=e.size/2,o=(e.size-e.strokewidth)/2,n=Math.PI*o*2,l=(1-r)*n,c='<svg class="svg" viewBox="0 0 '+e.size+" "+e.size+'" version="1.1" preserveAspectRatio="xMinYMin meet">';c+='<circle class="fl-bar-bg" r="'+o+'" cx="'+i+'" cy="'+i+'" stroke="#'+e.color.substr(0,6)+'" stroke-opacity="'+N2Color.hex2alpha(e.color)+'" stroke-width="'+e.strokewidth+'" stroke-dashoffset="0" stroke-dasharray="'+n+'" fill="transparent"></circle>',c+='<circle class="fl-bar" r="'+o+'" cx="'+i+'" cy="'+i+'" stroke="#'+e.color2.substr(0,6)+'" stroke-opacity="'+N2Color.hex2alpha(e.color2)+'" stroke-width="'+e.strokewidth+'" stroke-dasharray="'+n+'" stroke-dashoffset="'+l+'" transform="rotate(-90 '+i+" "+i+')" fill="transparent"></circle>',c+="</svg>";var p=t('<div class="n2-ow n2-ss-item-circlecounter-svg-container">'+c+"</div>").css({width:e.size}),d=t('<div class="n2-ow n2-ss-item-circlecounter-svg-overlay"></div>').appendTo(p);s.appendTo(d);var u=p.find("circle").eq(1),h=function(t){u.attr("stroke-dashoffset",(1-t)*n),s.html(e.pre+(e.min+t*(e.total-e.min)).toFixed(0)+e.post)};if(this.$item.append(p),e.label){var m=t('<div class="'+e.fontlabelclass+' n2-ow">'+e.label+"</div>");switch(e.labelplacement){case"before":m.insertBefore(p);break;case"innerbefore":m.insertBefore(s);break;case"innerafter":m.insertAfter(s);break;default:m.insertAfter(p)}}t({p:r}).animate({p:a},{duration:parseInt(e.animationduration),delay:parseInt(e.animationdelay),easing:"easeOutExpo",step:function(){h(this.p)},complete:function(){h(this.p)}})},s});